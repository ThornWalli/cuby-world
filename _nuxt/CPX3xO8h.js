import{C as R,a as K,b as Y,c as A,U as C,M as J,B as W,d as S,O as F,e as $,L,f as q,g as Q,h as X,A as Z,S as ee,G as te,V as ne,D as se,R as oe,i as ae,j as re}from"./Cu7CViZw.js";import{x as _,y as m,z as c,d as w,E as U,C as b,F as ie,B as v,G as y,_ as h,r as f,H as le,k as O,I as ue,J as ce,A as de,D as E,o as pe,K as me,L as ve,M as fe,N as be}from"./DSBH_P4y.js";const ge={xmlns:"http://www.w3.org/2000/svg",width:"14",height:"10",fill:"currentcolor"};function _e(d,e){return m(),_("svg",ge,[...e[0]||(e[0]=[c("path",{d:"M2 2h10v2H2zM2 6h10v2H2z"},null,-1)])])}const we={render:_e},he={class:"input"},Ue=["id"],Me={class:"indicator"},xe=w({__name:"Select",props:{id:{},label:{},hideLabel:{type:Boolean}},setup(d){return(e,t)=>(m(),U(R,{id:e.id,label:e.label,"hide-label":e.hideLabel,class:"cw-select"},{default:b(l=>[c("div",he,[c("select",{id:l.id},[ie(e.$slots,"default",{},()=>[t[0]||(t[0]=c("option",{value:"option1"},"Option 1",-1)),t[1]||(t[1]=c("option",{value:"option2"},"Option 2",-1)),t[2]||(t[2]=c("option",{value:"option3"},"Option 3",-1))],!0)],8,Ue),c("div",Me,[v(y(we))])])]),_:3},8,["id","label","hide-label"]))}}),Ce=h(xe,[["__scopeId","data-v-abb84f3b"]]),Se={label:"Units"},$e=["value"],ye=w({__name:"Controls",props:{units:{},debugOptions:{}},emits:["select-unit","rotate-unit","update:debug-options"],setup(d,{emit:e}){const t=f("");le(()=>t.value,s=>{o("select-unit",s)},{immediate:!!t.value});const l=d,r=O(()=>l.units.filter(s=>s.value!=="custom").map(s=>({name:s.name,value:s.value}))),o=e;function u(s){o("update:debug-options",{...l.debugOptions,...s})}return(s,a)=>(m(),U(A,{class:"cw-panel-controls"},{default:b(()=>[v(Ce,{modelValue:t.value,"onUpdate:modelValue":a[0]||(a[0]=p=>t.value=p),"label-top":"",label:"Select Unit",onChange:a[1]||(a[1]=p=>o("select-unit",p.target.value))},{default:b(()=>[a[4]||(a[4]=c("option",{value:""},"Select Unit",-1)),a[5]||(a[5]=c("optgroup",{label:"Debug"},[c("option",{value:"custom"},"Upload Unit")],-1)),c("optgroup",Se,[(m(!0),_(ue,null,ce(r.value,p=>(m(),_("option",{key:p.value,value:p.value},de(p.name),9,$e))),128))])]),_:1},8,["modelValue"]),v(K,{"model-value":s.debugOptions.axes,"onUpdate:modelValue":a[2]||(a[2]=p=>u({axes:p}))},{default:b(()=>[...a[6]||(a[6]=[E("Axis",-1)])]),_:1},8,["model-value"]),v(Y,{onClick:a[3]||(a[3]=p=>o("rotate-unit"))},{default:b(()=>[...a[7]||(a[7]=[E("Rotate",-1)])]),_:1})]),_:1}))}}),Oe=h(ye,[["__scopeId","data-v-0b742b66"]]),ze={xmlns:"http://www.w3.org/2000/svg",width:"14",height:"11",fill:"currentcolor"};function Be(d,e){return m(),_("svg",ze,[...e[0]||(e[0]=[c("path",{d:"M0 6h2v5H0zM6 3h2v4H6zM4 2h6v1H4zM5 1h4v1H5zM6 0h2v1H6zM12 6h2v5h-2zM2 9h10v2H2z"},null,-1)])])}const Ee={render:Be},Re=["id","accept"],Ae={class:"indicator"},Fe=w({__name:"Upload",props:{accept:{},label:{}},emits:["file"],setup(d,{emit:e}){const t=f(void 0),l=O(()=>t.value?.name||"Upload"),r=e;function o(u){const s=u.target?.files;t.value=s&&s.length>0?s[0]:void 0,r("file",t.value)}return(u,s)=>(m(),U(R,{label:l.value,"hide-colon":"",class:"cw-form-field-upload"},{default:b(a=>[c("input",{id:a.id,accept:u.accept,type:"file",onChange:o},null,40,Re),c("div",Ae,[v(y(Ee))])]),_:1},8,["label"]))}}),Le=h(Fe,[["__scopeId","data-v-88c2fb9a"]]),He=w({__name:"UnitManager",emits:["file"],setup(d,{emit:e}){const t=e;return(l,r)=>(m(),U(A,{class:"cw-panel-unit-manager"},{default:b(()=>[v(Le,{onFile:r[0]||(r[0]=o=>t("file",o))})]),_:1}))}}),De=h(He,[["__scopeId","data-v-121c0bff"]]);class Ve extends C{static KEY="box";static NAME="Box";options={size:.5};constructor(e={}){super({...e,name:"Box",selectable:!0})}createMesh(){const e=new J({color:16711680}),t=this.options.size,l=14/20,r=new W(t*1,t*l,t*1),o=new S(r,e);return o.name=F.MESH,o.castShadow=!0,o.position.set(0,t*l/2,0),this.materialReady$.next(),o}}const Ie=""+new URL("base.BuJoOUI2.glb",import.meta.url).href;class Ne extends C{static KEY="chair";static NAME="Chair";options={size:.5};constructor(e={}){super({...e,name:"Chair",selectable:!0})}createMesh({assetLoader:e}){const t=new $;return e.add({loader:L.GLTF,url:Ie}).then(l=>{const r=l.scene;r.scale.set(.4,.4,.4),r.position.y=0,r.name=F.MESH,r.traverse(o=>{o instanceof S&&(o.castShadow=!0,o.receiveShadow=!0)}),t.add(r)}),this.materialReady$.next(),t}}class H extends C{static KEY="custom";static NAME="Custom";options={size:.5};constructor(e={}){super({...e,name:"Custom",selectable:!0})}createMesh(e){return new $}}const Pe=[q,Q,Ve,X,Ne,H];function Te(d,e){return new Promise((t,l)=>{const r=new FileReader;r.onload=async o=>{try{const u=o.target?.result;if(u&&u instanceof ArrayBuffer){const s=await d.loaders[L.GLTF].parseAsync(u,"test");t(s.scene)}}catch(u){l(u)}},r.readAsArrayBuffer(e)})}const ke={class:"cw-debug-unit-preview"},Ge=w({__name:"UnitPreview",setup(d){let e,t;const l=new ee,r=f(),o=f(null),u=new Z,s=f(),a=f({axes:!1,gui:!1});function p(n){a.value=n;const i=k();i&&i.modules.debug&&(console.log("update debug options",n),i.modules.debug.setOptions(n))}const z=f(Pe.map(n=>({name:n.NAME,value:n.KEY,class:n})));pe(()=>{me(async()=>{D()})}),ve(()=>{t.disconnect(),l.unsubscribe()});function D(){const{$el:n,renderer:i}=o.value;if(!i)throw new Error("Renderer not ready");V(i);const g=()=>{r.value=new re(n.offsetWidth,n.offsetHeight),i.resize(r.value)};t=new ResizeObserver(g),t.observe(n)}function V(n){const i=n.scene,g=new te(new ne(0,0,0)).box,x=new S(g.geometry,g.material);x.material.side=se,x.receiveShadow=!0,i.add(x),e=new $,e.position.set(0,0,0),i.add(e),l.add(n.animationLoop$.subscribe(j=>{s.value&&s.value.update(j)}))}const B=f(""),I=O(()=>B.value==="custom");function N(n){if(B.value=n,n!=="upload"){console.log("select unit",n);const i=z.value.find(g=>g.value===n)?.class;T(i?new i:void 0)}}function P(){s.value&&s.value.rotateRight()}async function T(n){const i=s.value;i&&(e.remove(i.root),i.destroy()),n&&(await n.setup({unit:n,assetLoader:u}),s.value=be(n),e.add(n.root))}function k(){return o.value?.renderer}let M;async function G(n){n&&s.value instanceof H&&(M&&M.removeFromParent(),M=await Te(u,n),s.value.root.add(M))}return(n,i)=>(m(),_("div",ke,[v(oe,{ref_key:"rendererEl",ref:o,debug:a.value,modules:[y(ae)]},null,8,["debug","modules"]),v(Oe,{"debug-options":a.value,units:z.value,onSelectUnit:N,onRotateUnit:P,"onUpdate:debugOptions":p},null,8,["debug-options","units"]),I.value?(m(),U(De,{key:0,onFile:G})):fe("",!0)]))}}),je=h(Ge,[["__scopeId","data-v-ee96f676"]]),Ke=w({__name:"unit",setup(d){return(e,t)=>(m(),_("div",null,[v(je)]))}}),We=h(Ke,[["__scopeId","data-v-f719c23e"]]);export{We as default};
