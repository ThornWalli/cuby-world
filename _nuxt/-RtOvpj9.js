import{C as A,a as J,b as W,c as F,U as C,V as L,M as q,B as Q,d as y,O as H,e as S,L as D,f as X,g as Z,h as ee,A as te,S as ne,G as se,D as E,R as oe,i as ae,j as re}from"./BGNsA0yd.js";import{x as _,y as m,z as c,d as w,E as U,C as b,F as le,B as v,G as $,_ as h,r as f,H as ie,k as O,I as ue,J as ce,A as de,D as R,o as pe,K as me,L as ve,M as fe,N as be}from"./CtjQLM9l.js";const ge={xmlns:"http://www.w3.org/2000/svg",width:"14",height:"10",fill:"currentcolor"};function _e(d,e){return m(),_("svg",ge,[...e[0]||(e[0]=[c("path",{d:"M2 2h10v2H2zM2 6h10v2H2z"},null,-1)])])}const we={render:_e},he={class:"input"},Ue=["id"],Me={class:"indicator"},xe=w({__name:"Select",props:{id:{},label:{},hideLabel:{type:Boolean}},setup(d){return(e,t)=>(m(),U(A,{id:e.id,label:e.label,"hide-label":e.hideLabel,class:"cw-select"},{default:b(i=>[c("div",he,[c("select",{id:i.id},[le(e.$slots,"default",{},()=>[t[0]||(t[0]=c("option",{value:"option1"},"Option 1",-1)),t[1]||(t[1]=c("option",{value:"option2"},"Option 2",-1)),t[2]||(t[2]=c("option",{value:"option3"},"Option 3",-1))],!0)],8,Ue),c("div",Me,[v($(we))])])]),_:3},8,["id","label","hide-label"]))}}),Ce=h(xe,[["__scopeId","data-v-abb84f3b"]]),ye={label:"Units"},Se=["value"],$e=w({__name:"Controls",props:{units:{},debugOptions:{}},emits:["select-unit","rotate-unit","update:debug-options"],setup(d,{emit:e}){const t=f("");ie(()=>t.value,s=>{o("select-unit",s)},{immediate:!!t.value});const i=d,r=O(()=>i.units.filter(s=>s.value!=="custom").map(s=>({name:s.name,value:s.value}))),o=e;function u(s){o("update:debug-options",{...i.debugOptions,...s})}return(s,a)=>(m(),U(F,{class:"cw-panel-controls"},{default:b(()=>[v(Ce,{modelValue:t.value,"onUpdate:modelValue":a[0]||(a[0]=p=>t.value=p),"label-top":"",label:"Select Unit",onChange:a[1]||(a[1]=p=>o("select-unit",p.target.value))},{default:b(()=>[a[4]||(a[4]=c("option",{value:""},"Select Unit",-1)),a[5]||(a[5]=c("optgroup",{label:"Debug"},[c("option",{value:"custom"},"Upload Unit")],-1)),c("optgroup",ye,[(m(!0),_(ue,null,ce(r.value,p=>(m(),_("option",{key:p.value,value:p.value},de(p.name),9,Se))),128))])]),_:1},8,["modelValue"]),v(J,{"model-value":s.debugOptions.axes,"onUpdate:modelValue":a[2]||(a[2]=p=>u({axes:p}))},{default:b(()=>[...a[6]||(a[6]=[R("Axis",-1)])]),_:1},8,["model-value"]),v(W,{onClick:a[3]||(a[3]=p=>o("rotate-unit"))},{default:b(()=>[...a[7]||(a[7]=[R("Rotate",-1)])]),_:1})]),_:1}))}}),Oe=h($e,[["__scopeId","data-v-0b742b66"]]),ze={xmlns:"http://www.w3.org/2000/svg",width:"14",height:"11",fill:"currentcolor"};function Be(d,e){return m(),_("svg",ze,[...e[0]||(e[0]=[c("path",{d:"M0 6h2v5H0zM6 3h2v4H6zM4 2h6v1H4zM5 1h4v1H5zM6 0h2v1H6zM12 6h2v5h-2zM2 9h10v2H2z"},null,-1)])])}const Ee={render:Be},Re=["id","accept"],Ae={class:"indicator"},Fe=w({__name:"Upload",props:{accept:{},label:{}},emits:["file"],setup(d,{emit:e}){const t=f(void 0),i=O(()=>t.value?.name||"Upload"),r=e;function o(u){const s=u.target?.files;t.value=s&&s.length>0?s[0]:void 0,r("file",t.value)}return(u,s)=>(m(),U(A,{label:i.value,"hide-colon":"",class:"cw-form-field-upload"},{default:b(a=>[c("input",{id:a.id,accept:u.accept,type:"file",onChange:o},null,40,Re),c("div",Ae,[v($(Ee))])]),_:1},8,["label"]))}}),Le=h(Fe,[["__scopeId","data-v-88c2fb9a"]]),He=w({__name:"UnitManager",emits:["file"],setup(d,{emit:e}){const t=e;return(i,r)=>(m(),U(F,{class:"cw-panel-unit-manager"},{default:b(()=>[v(Le,{onFile:r[0]||(r[0]=o=>t("file",o))})]),_:1}))}}),De=h(He,[["__scopeId","data-v-121c0bff"]]);class Ve extends C{static KEY="box";static NAME="Box";constructor(e={}){super({...e,size:new L(.5,.5,.5),name:"Box",selectable:!0,placeable:!0})}createMesh(){const e=new q({color:16711680}),t=this.size,i=14/20,r=new Q(t.x*1,t.y*i,t.z*1),o=new y(r,e);return o.name=H.MESH,o.castShadow=!0,o.position.set(0,t.y*i/2,0),this.materialReady$.next(),o}}const Ie=""+new URL("base.BuJoOUI2.glb",import.meta.url).href;class Ne extends C{static KEY="chair";static NAME="Chair";constructor(e={}){super({...e,name:"Chair",selectable:!0,placeable:!0})}createMesh({assetLoader:e}){const t=new S;return e.add({loader:D.GLTF,url:Ie}).then(i=>{const r=i.scene;r.scale.set(.4,.4,.4),r.position.y=0,r.name=H.MESH,r.traverse(o=>{o instanceof y&&(o.castShadow=!0,o.receiveShadow=!0)}),t.add(r)}),this.materialReady$.next(),t}}class V extends C{static KEY="custom";static NAME="Custom";constructor(e={}){super({...e,name:"Custom",selectable:!0,placeable:!0})}createMesh(e){return new S}}const Pe=[X,Z,Ve,ee,Ne,V];function Te(d,e){return new Promise((t,i)=>{const r=new FileReader;r.onload=async o=>{try{const u=o.target?.result;if(u&&u instanceof ArrayBuffer){const s=await d.loaders[D.GLTF].parseAsync(u,"test");t(s.scene)}}catch(u){i(u)}},r.readAsArrayBuffer(e)})}const ke={class:"cw-debug-unit-preview"},Ge=w({__name:"UnitPreview",setup(d){let e,t;const i=new ne,r=f(),o=f(null),u=new te,s=f(),a=f({axes:!1,gui:!1});function p(n){a.value=n;const l=j();l&&l.modules.debug&&(console.log("update debug options",n),l.modules.debug.setOptions(n))}const z=f(Pe.map(n=>({name:n.NAME,value:n.KEY,class:n})));pe(()=>{me(async()=>{I()})}),ve(()=>{t.disconnect(),i.unsubscribe()});function I(){const{$el:n,renderer:l}=o.value;if(!l)throw new Error("Renderer not ready");N(l);const g=()=>{r.value=new re(n.offsetWidth,n.offsetHeight),l.resize(r.value)};t=new ResizeObserver(g),t.observe(n)}function N(n){const l=n.scene,g=new se(new L(0,0,0)).box,x=new y(g.geometry,g.material);x.material.side=E,x.receiveShadow=!0,x.material.side=E,l.add(x),e=new S,e.position.set(0,0,0),l.add(e),i.add(n.animationLoop$.subscribe(Y=>{s.value&&s.value.update(Y)}))}const B=f(""),P=O(()=>B.value==="custom");function T(n){if(B.value=n,n!=="upload"){console.log("select unit",n);const l=z.value.find(g=>g.value===n)?.class;G(l?new l:void 0)}}function k(){s.value&&s.value.rotateRight()}async function G(n){const l=s.value;l&&(e.remove(l.root),l.destroy()),n&&(await n.setup({unit:n,assetLoader:u}),s.value=be(n),e.add(n.root))}function j(){return o.value?.renderer}let M;async function K(n){n&&s.value instanceof V&&(M&&M.removeFromParent(),M=await Te(u,n),s.value.root.add(M))}return(n,l)=>(m(),_("div",ke,[v(oe,{ref_key:"rendererEl",ref:o,debug:a.value,modules:[$(ae)]},null,8,["debug","modules"]),v(Oe,{"debug-options":a.value,units:z.value,onSelectUnit:T,onRotateUnit:k,"onUpdate:debugOptions":p},null,8,["debug-options","units"]),P.value?(m(),U(De,{key:0,onFile:K})):fe("",!0)]))}}),je=h(Ge,[["__scopeId","data-v-493c5584"]]),Ke=w({__name:"unit",setup(d){return(e,t)=>(m(),_("div",null,[v(je)]))}}),We=h(Ke,[["__scopeId","data-v-f719c23e"]]);export{We as default};
